static void ShowAuftragHtml(int auftragsNr)
{
    var conn = new NpgsqlConnection(connectionString);
    conn.Open();

    var rechnung = GetDictionaryFromTable("rechnung", "auftragsnr", auftragsNr);

    // CSS styles
    string style = @"
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 20px;
    }
    .header, .footer {
        text-align: left;
        margin-bottom: 20px;
    }
    .header img {
        float: left;
        margin-right: 20px;
    }
    .header h1 {
        margin: 0;
    }
    .header .details {
        float: right;
        text-align: right;
    }
    .clear {
        clear: both;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }
    table, th, td {
        border: 1px solid black;
    }
    th, td {
        padding: 8px;
        text-align: left;
    }
    .no-border {
        border: none;
    }
</style>";

    // Start building HTML
    string html = $@"
<!DOCTYPE html>
<html lang=""en"">
<head>
    <meta charset=""UTF-8"">
    <title>Rechnung</title>
    {style}
</head>
<body>";

    // Build header
    html += @"
    <div class=""header"">
        <img src=""logo.png"" alt=""Company Logo"" width=""100"">
        <div class=""details"">
            <p>Winkler KG, Schulstr.11, 12345 Neuheim</p>
            <p>An: Manfred Heller<br>
               Dinkelstrasse 39<br>
               34056 Mauerbach</p>
        </div>
        <div class=""clear""></div>
        <h1>Rechnung</h1>
    </div>";

    // Build main content table
    html += @"
    <table>
        <tr>
            <td class=""no-border"">Auftrags Nr. <strong>" + auftragsNr + @"</strong></td>
            <td class=""no-border"">Kunden Nr. <strong>" + rechnung["kundennr"] + @"</strong></td>
            <td class=""no-border"">Datum <strong>" + rechnung["datum"] + @"</strong></td>
            <td class=""no-border"">Bearbeiter <strong>" + rechnung["bearbeiter"] + @"</strong></td>
        </tr>
    </table>";

    // Build position table
    var positionen = GetPositionen(auftragsNr);
    html += @"
    <table>
        <thead>
            <tr>
                <th>Pos. Nr.</th>
                <th>Artikel Nr.</th>
                <th>Artikel</th>
                <th>Menge</th>
                <th>Einzelpreis</th>
                <th>Gesamtpreis</th>
            </tr>
        </thead>
        <tbody>";

    foreach (var positionKvp in positionen)
    {
        html += $@"
            <tr>
                <td>{positionKvp.Key}</td>
                <td>{positionKvp.Value["artikelnr"]}</td>
                <td>{positionKvp.Value["artikel"]}</td>
                <td>{positionKvp.Value["menge"]}</td>
                <td>{positionKvp.Value["einzelpreis"]} €</td>
                <td>{positionKvp.Value["gesamtpreis"]} €</td>
            </tr>";
    }

    html += @"
        </tbody>
        <tfoot>
            <tr>
                <td colspan=""4"" class=""no-border""></td>
                <td>Netto-Betrag</td>
                <td>" + rechnung["nettowert"] + @" €</td>
            </tr>
            <tr>
                <td colspan=""4"" class=""no-border""></td>
                <td>19% MwSt</td>
                <td>" + rechnung["mwst"] + @" €</td>
            </tr>
            <tr>
                <td colspan=""4"" class=""no-border""></td>
                <td><strong>Gesamt-Betrag</strong></td>
                <td><strong>" + rechnung["bruttowert"] + @" €</strong></td>
            </tr>
        </tfoot>
    </table>";

    // Remaining text
    html += @"
    <p>Wir danken für Ihren Einkauf</p>
    <p>Zahlungsvermerk: " + rechnung["zahlungsvermerkung"] + @"<br>Zahlbar bis " + rechnung["fälligkeitsdatum"] + @"</p>";

    // Build footer
    html += @"
    <div class=""footer"">
        <p>Bankname: Deutsche Bank<br>Konto: " + rechnung["kontonr"] + @"<br>BLZ: " + rechnung["blz"] + @"<br>Steuernummer: " + rechnung["steuernummer"] + @"<br>US-ID-Nr: " + rechnung["ustidnr"] + @"<br>Amtsgericht " + rechnung["amtsgericht"] + @"<br>HBR " + rechnung["hbr"] + @"<br>Firmensitz: Neuheim<br>" + rechnung["straße"] + @", 75175 Neuheim<br>Tel.: " + rechnung["telefon"] + @"<br>Fax: " + rechnung["fax"] + @"<br>Geschäftsführung: " + rechnung["geschäftsführung"] + @"</p>
    </div>";

    html += @"
</body>
</html>";

    System.IO.File.WriteAllText("auftrag.html", html);

    conn.Close();
}
